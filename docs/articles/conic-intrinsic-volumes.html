<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conic intrinsic volumes and the (bivariate) chi-bar-squared distribution • conivol</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Conic intrinsic volumes and the (bivariate) chi-bar-squared distribution">
<meta property="og:description" content="">
<meta property="og:image" content="http://damelunx.github.io/conivol/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">conivol</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/conivol.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/conic-intrinsic-volumes.html">Conic intrinsic volumes and (bivariate) chi-bar-squared distribution</a>
    </li>
    <li>
      <a href="../articles/estim-conic-intrinsic-volumes-with-EM.html">Estimating conic intrinsic volumes from bivariate chi-bar-squared data</a>
    </li>
    <li>
      <a href="../articles/bayesian.html">Bayesian estimates for conic intrinsic volumes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/damelunx/conivol">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Conic intrinsic volumes and the (bivariate) chi-bar-squared distribution</h1>
                        <h4 class="author">Dennis Amelunxen</h4>
            
            <h4 class="date">2018-04-12</h4>
          </div>

    
    
<div class="contents">
<p>This note introduces the conic intrinsic volumes and the associated (bivariate) chi-bar-squared distributions. The focus is on algorithmic considerations; see the survey paper <span class="citation">(Amelunxen and Lotz <a href="#ref-AL17">2017</a>)</span> and the references therein for more background on the conic intrinsic volumes. We will give further pointers to the literature within the text below.</p>
<p><strong>Other vignettes:</strong></p>
<ul>
<li>
<a href="estim-conic-intrinsic-volumes-with-EM.html">Estimating conic intrinsic volumes from bivariate chi-bar-squared data</a>: describes the details of the algorithm for finding the intrinsic volumes of closed convex cones from samples of the associated bivariate chi-bar-squared distribution,</li>
<li>
<a href="bayesian.html">Bayesian estimates for conic intrinsic volumes</a>: describes the Bayesian approach for reconstructing intrinsic volumes from sampling data, which can either be samples from the intrinsic volumes distribution (in the case of polyhedral cones), or from the bivariate chi-bar-squared distribution, and which can be with or without enforcing log-concavity of the intrinsic volumes.</li>
</ul>
<div id="cl_conv_con" class="section level2">
<h2 class="hasAnchor">
<a href="#cl_conv_con" class="anchor"></a>Closed convex cones</h2>
<p>As the name suggests, a closed convex cone <span class="math inline">\(C\subseteq\text{R}^d\)</span> satisfies the following three properties:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(C\)</span> is <strong>closed</strong>:<br>
the limit of any convergent sequence is an element of <span class="math inline">\(C\)</span>, <span class="math display">\[ \forall x_1,x_2,\ldots\in C \text{ such that } \lim_{i\to\infty} x_i
\text{ exists}: \lim_{i\to\infty} x_i\in C \]</span>
</li>
<li>
<span class="math inline">\(C\)</span> is <strong>convex</strong>:<br>
any convex combination of elements in <span class="math inline">\(C\)</span> lies in <span class="math inline">\(C\)</span>,<br><span class="math display">\[ \forall x,y\in C,\; 0\leq \lambda\leq 1 : \lambda x+(1-\lambda) y\in C \]</span>
</li>
<li>
<span class="math inline">\(C\)</span> is a <strong>cone</strong>:<br>
any positive scaling of an element in <span class="math inline">\(C\)</span> lies in <span class="math inline">\(C\)</span>, <span class="math display">\[ \forall x\in C\;,\lambda&gt;0 : \lambda x\in C \]</span>
</li>
</ol>
<p>Properties 1. and 3. imply that every nonzero closed cone contains the origin, <span class="math inline">\(0\in C\)</span>. Furthermore, if <span class="math inline">\(0\in C\)</span>, then properties 2. and 3. taken together are equivalent to the property <span class="math display">\[ \forall x,y\in C,\; \lambda,\mu\geq0 : \lambda x+\mu y\in C \]</span> In other words, a (nonempty) closed convex cone is a closed set, which is <strong>closed under nonnegative linear combinations</strong>. Compare this to linear subspaces which can be characterized through their closedness under (possibly negative) linear combinations.</p>
<p><strong>Note:</strong></p>
<ul>
<li>Below we will always assume that closed convex cones are nonempty, hence, they contain at least the origin.</li>
<li>If <span class="math inline">\(C\subseteq\text{R}^d\)</span> and <span class="math inline">\(D\subseteq\text{R}^e\)</span> are closed convex cones, then their direct product is a closed convex cone, <span class="math inline">\(C\times D\subseteq\text{R}^{d+e}\)</span>.</li>
</ul>
<div id="pol_con" class="section level3">
<h3 class="hasAnchor">
<a href="#pol_con" class="anchor"></a>Polar cones</h3>
<p>Every closed convex cone <span class="math inline">\(C\subseteq\text{R}^d\)</span> defines a natural counterpart, its polar cone <span class="math display">\[ C^\circ := \{y\in\text{R}^d\mid \forall x\in C: x^Ty\leq 0\} . \]</span> The polar cone is also a closed convex cone, and the polar of the polar cone is the original cone, which in this context is also called the primal cone, <span class="math inline">\((C^\circ)^\circ = C\)</span>. It thus makes sense to think about the primal cone and its polar cone as a primal-polar pair of cones. A cone is called self-dual, if <span class="math inline">\(C^\circ=-C\)</span>.</p>
<p>Note that <span class="math inline">\((\text{R}^d)^\circ=\{0\}\)</span>. Also, polarity behaves well with direct products, <span class="math inline">\((C\times D)^\circ = C^\circ\times D^\circ\)</span>.<br>
The polar cone depends on the ambient space, i.e., if we embed <span class="math inline">\(C\subseteq\text{R}^d\)</span> in <span class="math inline">\(\text{R}^e\)</span>, <span class="math inline">\(e\geq d\)</span>, by formally identifying <span class="math inline">\(C\)</span> with <span class="math inline">\(C\times\{0\}\subseteq\text{R}^e\)</span>, then the polar of the embedded cone is given by <span class="math inline">\((C\times\{0\})^\circ = C^\circ\times\text{R}^{e-d}\)</span> (as opposed to the polar of <span class="math inline">\(C\)</span> in <span class="math inline">\(\text{R}^d\)</span> embedded in <span class="math inline">\(\text{R}^e\)</span>).</p>
<p>If the cone <span class="math inline">\(C\)</span> is transformed by an invertible linear transformation then its polar cone is transformed by the transpose of the inverse of the transformation: <span class="math display">\[ (AC)^\circ = B^T C^\circ ,\qquad \text{if $A$ invertible and } B=A^{-1} . \]</span></p>
</div>
<div id="dim_lin" class="section level3">
<h3 class="hasAnchor">
<a href="#dim_lin" class="anchor"></a>Dimension and lineality</h3>
<p>The smallest linear space containing a cone <span class="math inline">\(C\)</span> is given by <span class="math inline">\(C+(-C)\)</span>, and the largest linear space contained in <span class="math inline">\(C\)</span>, called the lineality space of <span class="math inline">\(C\)</span>, is given by <span class="math inline">\(C\cap (-C)\)</span>. Linear hull and lineality space are related by polarity, as</p>
<p><span class="math display">\[ C^\circ+(-C^\circ) = (C\cap (-C))^\bot ,\quad C^\circ\cap(-C^\circ) = (C+(-C))^\bot , \]</span> where <span class="math inline">\(L^\bot\)</span> denotes the orthogonal complement of a linear space. Every closed convex cone has the natural orthogonal decomposition <span class="math display">\[ C = L + \bar C , \]</span> where <span class="math inline">\(L=C\cap (-C)\)</span> denotes the lineality space, and <span class="math inline">\(\bar C=\Pi_{L^\bot}(C)\)</span> the image of the projection of <span class="math inline">\(C\)</span> onto the orthogonal complement of <span class="math inline">\(L\)</span>.</p>
<p>The (linear) dimension of a cone is the dimension of its linear hull, and the lineality of a cone is the dimension of its lineality space,</p>
<p><span class="math display">\[ \text{dim}(C) = \text{dim}(C+(-C)) ,\quad \text{lin}(C) = \text{dim}(C\cap(-C)) . \]</span> Note that by the above polarity statement we have <span class="math inline">\(\text{dim}(C)=d-\text{lin}(C^\circ)\)</span> and <span class="math inline">\(\text{lin}(C)=d-\text{dim}(C^\circ)\)</span>.</p>
</div>
<div id="lin_subsp" class="section level3">
<h3 class="hasAnchor">
<a href="#lin_subsp" class="anchor"></a>Examples: linear subspaces</h3>
<p>A trivial yet important class of examples of closed convex cones are the linear subspaces. It is easily seen that the polar cone of a linear subspace is just its orthogonal complement. Clearly, a cone is a linear space iff <span class="math inline">\(\text{dim}(C)=\text{lin}(C)\)</span>.</p>
<p>The intrinsic volumes and (bivariate) chi-bar-squared distributions (see <a href="#bivchibarsq">below</a>) are in this case equivalent to the dimension of the subspace and the chi-squared distribution (see <a href="#bivchibars_cone">below</a> for more precise statements).</p>
<p>Furthermore, for cones which are not linear subspaces the intrinsic volumes satisfy an additional linear relation, which is why the algorithms in <code>conivol</code> assume that the underlying closed convex cone is <strong>not</strong> a linear subspace.</p>
</div>
<div id="polyh_cones" class="section level3">
<h3 class="hasAnchor">
<a href="#polyh_cones" class="anchor"></a>Examples: polyhedral cones</h3>
<p>Polyhedral cones are a straightforward generalization of linear subspaces and can be described in two ways, which are related via polarity:</p>
<ol style="list-style-type: decimal">
<li>as nonnegative linear combinations of a finite number of vectors, <span class="math display">\[ C = \{Az \mid z\in\text{R}^n, z\geq 0\} ,\quad A\in\text{R}^{d\times n} , \]</span> where the inequality <span class="math inline">\(z\geq0\)</span> is meant componentwise,</li>
<li>as the intersection of finitely many closed linear half-spaces, <span class="math display">\[ C^\circ = \{y\in\text{R}^d \mid A^Ty\leq 0\} . \]</span>
</li>
</ol>
<p>Although the set of polyhedral cones does not exhaust the set of closed convex cones, it can be shown (and it is intuitively clear) that every closed convex cone can be arbitrarily well approximated by polyhedral cones.</p>
<p>For later use we recall that a face of a polyhedral cone is the intersection of a linear hyperplane (linear subspace of codimension one) with the cone, where the cone has to lie entirely in one of the two closed half-spaces defined by the hyperplane. Every polyhedral cone has a finite number of faces, and decomposes into the disjoint union of the relative interiors of its faces, <span class="math display">\[ C = \dot{\bigcup_{F\text{ face of } C}} \text{relint}(F) .  \]</span></p>
<p>We can compute the dimension, lineality, the orthogonal decomposition <span class="math inline">\(C=L+\bar C\)</span>, as well as a reduced representation of <span class="math inline">\(\bar C\)</span> as follows (see <span class="citation">(Wets and Witzgall <a href="#ref-WW67">1967</a>)</span> for more details):</p>
<ul>
<li>The linear hull of <span class="math inline">\(C\)</span> can be found through the singular value decomposition (SVD) of <span class="math inline">\(A\)</span>; the left-singular vectors will form an orthogonal basis of this space.</li>
<li>The lineality space of <span class="math inline">\(C\)</span> can be found by each column of <span class="math inline">\(A\)</span> whether its negative lies in <span class="math inline">\(C\)</span>; the set of these vectors spans the lineality space of <span class="math inline">\(C\)</span>, and an orthogonal basis can again be found via SVD.</li>
<li>The reduced cone is then found by projecting the remaining vectors on the orthogonal complement of the lineality space.</li>
</ul>
<p>The function <code>polyh_reduce_gen</code> does exactly this. Concretely, for <span class="math inline">\(C\)</span> defined as above through the matrix <span class="math inline">\(A\)</span>, it finds matrices <span class="math display">\[ Q_L\in\text{R}^{d\times\text{lin}(C)} ,
    Q_C\in\text{R}^{d\times e} ,
    \tilde A\in \text{R}^{e\times m} , \]</span> where <span class="math inline">\(e=\text{dim}(C)-\text{lin}(C)\)</span>, and with <span class="math inline">\(Q_L^TQ_L=I_{\text{lin}(C)}\)</span> and <span class="math inline">\(Q_C^TQ_C=I_e\)</span>, such that <span class="math display">\[ L=Q_L\cdot\text{R}^{\text{lin}(C)} ,\quad
    \bar C=Q_C \{\tilde A\tilde z \mid \tilde z\in\text{R}^m,
    \tilde z\geq 0\} . \]</span> In other words, the matrix <span class="math inline">\(\tilde A\)</span> is a reduced form of the matrix <span class="math inline">\(A\)</span> generating (essentially) the same cone as <span class="math inline">\(A\)</span>.</p>
<p>If the cone is given by inequalities (as is <span class="math inline">\(C^\circ\)</span>; we use a different notation here to avoid confusing notation), like <span class="math inline">\(D=\{y\in\text{R}^d \mid A^Ty\leq 0\}\)</span>, then the orthogonal decomposition <span class="math inline">\(D=M+\bar D\)</span>, with <span class="math inline">\(M\)</span> denoting the lineality space of <span class="math inline">\(D\)</span>, is given as follows: <span class="math display">\[ M=\{y\in\text{R}^d\mid Q_L^Ty=0, Q_C^Ty=0\} ,\quad
    \bar D=Q_C \{\tilde y\in\text{R}^e \mid \tilde A^T\tilde y\leq 0\}  . \]</span> Where <span class="math inline">\(Q_L, Q_C, \tilde A\)</span> are the same matrices as above (returned by <code>polyh_reduce_gen</code>); the function <code>polyh_reduce_ineq</code> returns these same matrices but with adjusted values for dimension and lineality of the cone (another reason for having two functions doing essentially the same thing is so that the corresponding help pages do not have to cover both cases).</p>
<p><strong>Example computations:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(-(<span class="dv">1</span>:<span class="dv">4</span>),<span class="dv">1</span>:<span class="dv">24</span>),<span class="dv">4</span>,<span class="dv">7</span>); A
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span>
<span class="co">#&gt; [1,]   -1    1    5    9   13   17   21</span>
<span class="co">#&gt; [2,]   -2    2    6   10   14   18   22</span>
<span class="co">#&gt; [3,]   -3    3    7   11   15   19   23</span>
<span class="co">#&gt; [4,]   -4    4    8   12   16   20   24</span>
<span class="kw"><a href="../reference/polyh_reduce.html">polyh_reduce_gen</a></span>(A)
<span class="co">#&gt; $dimC</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $linC</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $QL</span>
<span class="co">#&gt;            [,1]</span>
<span class="co">#&gt; [1,] -0.1825742</span>
<span class="co">#&gt; [2,] -0.3651484</span>
<span class="co">#&gt; [3,] -0.5477226</span>
<span class="co">#&gt; [4,] -0.7302967</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $QC</span>
<span class="co">#&gt;               [,1]</span>
<span class="co">#&gt; [1,]  8.164966e-01</span>
<span class="co">#&gt; [2,]  4.082483e-01</span>
<span class="co">#&gt; [3,]  3.115041e-16</span>
<span class="co">#&gt; [4,] -4.082483e-01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $A_reduced</span>
<span class="co">#&gt; [1] 1</span>
<span class="kw"><a href="../reference/polyh_reduce.html">polyh_reduce_ineq</a></span>(A)
<span class="co">#&gt; $dimC</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $linC</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $QL</span>
<span class="co">#&gt;            [,1]</span>
<span class="co">#&gt; [1,] -0.1825742</span>
<span class="co">#&gt; [2,] -0.3651484</span>
<span class="co">#&gt; [3,] -0.5477226</span>
<span class="co">#&gt; [4,] -0.7302967</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $QC</span>
<span class="co">#&gt;               [,1]</span>
<span class="co">#&gt; [1,]  8.164966e-01</span>
<span class="co">#&gt; [2,]  4.082483e-01</span>
<span class="co">#&gt; [3,]  3.115041e-16</span>
<span class="co">#&gt; [4,] -4.082483e-01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $A_reduced</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
</div>
<div id="simpl_weyl" class="section level3">
<h3 class="hasAnchor">
<a href="#simpl_weyl" class="anchor"></a>Examples: simplicial cones and Weyl chambers of finite reflection groups</h3>
<p>A special class of polyhedral cones is given by so-called simplicial cones. These are full-dimensional cones with a minimal number of edges and facets. Formally, we can describe these cones as positive orthants transformed by an invertible linear transformation: <span class="math display">\[ \big\{\text{simplicial cones in }\text{R}^d\big\}
    = \big\{A\text{R}_+^d\mid A\in\text{R}^{d\times d} \text{ invertible} \big\} . \]</span> In other words, a simplicial cone is generated by the columns of an invertible matrix. Note that since the positive orthant is self-dual, <span class="math inline">\((\text{R}_+^d)^\circ=-\text{R}_+^d\)</span>, we easily obtain the polar cone of a simplicial cone through the inverse matrix, <span class="math display">\[ \big( A\text{R}_+^d \big)^\circ = -B^T\text{R}_+^d ,\qquad
    \text{if $A$ invertible and } B=A^{-1} . \]</span></p>
A special class of simplicial cones are the Weyl chambers of finite reflection groups of which the most important ones are of class ‘A’, ‘BC’, and ‘D’. These chambers are isometric to the following three cones,
<span class="math display">\[\begin{align*}
   C_A &amp; = \big\{ x\in\text{R}^{d+1} \mid x_1 \leq x_2 \leq \dots \leq x_{d+1} \big\} ,
\\ C_{BC} &amp; = \big\{ x\in\text{R}^d \mid 0\leq x_1 \leq x_2 \leq \dots \leq x_d \big\} ,
\\ C_D &amp; = \big\{ x\in\text{R}^d \mid -x_2\leq x_1 \leq x_2 \leq \dots \leq x_d \big\} .
\end{align*}\]</span>
Note that the first cone is strictly speaking not simplicial, as it contains the one-dimensional linear subspace <span class="math inline">\(L=\{\lambda 1_d\mid \lambda\in\text{R}\}\)</span>, where <span class="math inline">\(1_d\in\text{R}^d\)</span> denotes the all-one vector. However, the projection of <span class="math inline">\(C\)</span> onto the orthogonal complement of <span class="math inline">\(L\)</span> yields the natural orthogonal decomposition <span class="math inline">\(C_A=L+\bar C_A\)</span>, and the projection <span class="math inline">\(\bar C_A\)</span> is indeed a simplicial cone. Using the matrix description <span class="math inline">\(\{y\in\text{R}^d \mid A^Ty\leq 0\}\)</span>, we see that the above defined cones correspond to the matrices
<span class="math display">\[\begin{align*}
   A_A &amp; = \begin{pmatrix}
       1
    \\ -1 &amp; 1
    \\    &amp; \ddots &amp; \ddots
    \\    &amp; &amp; -1 &amp; 1
    \\    &amp; &amp; &amp; -1
    \end{pmatrix} ,
   &amp; A_{BC} &amp; = \begin{pmatrix}
       -1 &amp; 1
    \\    &amp; \ddots &amp; \ddots
    \\    &amp; &amp; -1 &amp; 1
    \\    &amp; &amp; &amp; -1
    \end{pmatrix} ,
   \\ A_D &amp; = \begin{pmatrix}
       -1 &amp; 1
    \\ -1 &amp;-1 &amp; 1
    \\    &amp; &amp; -1 &amp; 1
    \\    &amp; &amp; &amp; \ddots &amp; \ddots
    \\    &amp; &amp; &amp; &amp; -1 &amp; 1
    \\    &amp; &amp; &amp; &amp; &amp; -1
    \end{pmatrix} .
\end{align*}\]</span>
<p>The truly simplicial cone <span class="math inline">\(\bar C_A\)</span> corresponds to the matrix <span class="math display">\[ \bar A_A = Q^T A_A , \]</span> where <span class="math inline">\(Q\in \text{R}^{(d+1)\times d}\)</span> is such that its columns form an orthonormal basis of <span class="math inline">\(L^\bot\)</span>.</p>
The polar cones <span class="math inline">\({C}^\circ_A, \bar C_A^\circ, {C}^\circ_{BC}, {C}^\circ_D\)</span> (the polar cone of <span class="math inline">\(\bar C_A^\circ\)</span> taken in the ambient space <span class="math inline">\(L^\bot\)</span>) correspond to the following matrices:
<span class="math display">\[\begin{align*}
   {A}^\circ_A &amp; = \begin{pmatrix}
       -1 &amp; 1 &amp; -d &amp; -d+1 &amp; \dots &amp; -1
    \\ -1 &amp; 1 &amp; 1 &amp; -d+1 &amp; &amp; \vdots
    \\ -1 &amp; 1 &amp; 1 &amp; 2 &amp; \ddots &amp; -1
    \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; -1
    \\ -1 &amp; 1 &amp; 1 &amp; 2 &amp; \dots &amp; d
    \end{pmatrix} ,
 &amp;  \bar A_A^\circ &amp; = Q^T \begin{pmatrix}
       -d &amp; -d+1 &amp; \dots &amp; -1
    \\ 1 &amp; -d+1 &amp; &amp; \vdots
    \\ 1 &amp; 2 &amp; \ddots &amp; -1
    \\ \vdots &amp; \vdots &amp; \ddots &amp; -1
    \\ 1 &amp; 2 &amp; \dots &amp; d
    \end{pmatrix} ,
\\ {A}^\circ_{BC} &amp; = \begin{pmatrix}
       1
    \\ 1 &amp; 1
    \\ \vdots &amp; \dots &amp; \ddots
    \\ 1 &amp; \dots &amp; \dots &amp; 1
    \end{pmatrix} ,
 &amp; {A}^\circ_D &amp; = \begin{pmatrix}
       1 &amp; -1
    \\ 1 &amp; 1
    \\ 1 &amp; 1 &amp; 1
    \\ 1 &amp; 1 &amp; 1 &amp; 1
    \\ \vdots &amp; \vdots &amp; \vdots &amp; \dots &amp; \ddots
    \\ 1 &amp; 1 &amp; 1 &amp; \dots &amp; \dots &amp; 1
    \end{pmatrix} .
\end{align*}\]</span>
<p>These matrices can be obtained through the function <code>weyl_matrix</code>.</p>
<p><strong>Example computations:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw"><a href="../reference/weyl_matrix.html">weyl_matrix</a></span>(<span class="dv">5</span>,<span class="st">"A"</span>)
A_red &lt;-<span class="st"> </span><span class="kw"><a href="../reference/weyl_matrix.html">weyl_matrix</a></span>(<span class="dv">5</span>,<span class="st">"A_red"</span>)
<span class="kw">list</span>( <span class="dt">A=</span>A, <span class="dt">A_red=</span>A_red )
<span class="co">#&gt; $A</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; [1,]    1    0    0    0    0</span>
<span class="co">#&gt; [2,]   -1    1    0    0    0</span>
<span class="co">#&gt; [3,]    0   -1    1    0    0</span>
<span class="co">#&gt; [4,]    0    0   -1    1    0</span>
<span class="co">#&gt; [5,]    0    0    0   -1    1</span>
<span class="co">#&gt; [6,]    0    0    0    0   -1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $A_red</span>
<span class="co">#&gt;            [,1]          [,2]          [,3]          [,4]       [,5]</span>
<span class="co">#&gt; [1,] -0.5576775  9.659258e-01 -1.115355e+00  9.659258e-01 -0.5576775</span>
<span class="co">#&gt; [2,] -0.8660254  8.660254e-01  1.665335e-16 -8.660254e-01  0.8660254</span>
<span class="co">#&gt; [3,]  0.8164966 -8.326673e-16 -8.164966e-01  1.110223e-15  0.8164966</span>
<span class="co">#&gt; [4,] -0.5000000 -5.000000e-01  3.330669e-16  5.000000e-01  0.5000000</span>
<span class="co">#&gt; [5,]  0.1494292  2.588190e-01  2.988585e-01  2.588190e-01  0.1494292</span></code></pre></div>
<p>The representing matrices for <span class="math inline">\(C_A\)</span> and <span class="math inline">\(\bar C_A\)</span> sure look different, but checking the angles between the columns reveals that they represent the same cone:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t</span>(A) %*%<span class="st"> </span>A
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; [1,]    2   -1    0    0    0</span>
<span class="co">#&gt; [2,]   -1    2   -1    0    0</span>
<span class="co">#&gt; [3,]    0   -1    2   -1    0</span>
<span class="co">#&gt; [4,]    0    0   -1    2   -1</span>
<span class="co">#&gt; [5,]    0    0    0   -1    2</span>
<span class="kw">round</span>( <span class="kw">t</span>(A_red) %*%<span class="st"> </span>A_red ,<span class="dt">digits=</span><span class="dv">14</span>)
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; [1,]    2   -1    0    0    0</span>
<span class="co">#&gt; [2,]   -1    2   -1    0    0</span>
<span class="co">#&gt; [3,]    0   -1    2   -1    0</span>
<span class="co">#&gt; [4,]    0    0   -1    2   -1</span>
<span class="co">#&gt; [5,]    0    0    0   -1    2</span></code></pre></div>
</div>
<div id="circ_con" class="section level3">
<h3 class="hasAnchor">
<a href="#circ_con" class="anchor"></a>Examples: circular cones</h3>
Circular cones consist of all points that lie below a certain angle towards a given (half-)line. Choosing this line to be the <span class="math inline">\(d\)</span>th coordinate axis, we define the <span class="math inline">\(d\)</span>-dimensional circular cone of angle <span class="math inline">\(0&lt;\alpha&lt;\frac{\pi}{2}\)</span> via
<span class="math display">\[\begin{align*}
   \text{Circ}_d(\alpha) &amp; := \{x\in\text{R}^d\mid x_d\geq \cos(\alpha)\|x\|\}
\\ &amp; = \Big\{x\in\text{R}^d\mid x_d\geq 0 ,\; x_d^2\geq \sum_{k=1}^{d-1}
    \frac{x_k^2}{\tan(\alpha)^2} \Big\} ,
\end{align*}\]</span>
<p>where <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.</p>
<p>The circular cones form a class of cones, which is interesting for both theoretical and practical purposes. For theoretical purposes because circular cones are known to satisfy certain extreme inequalities (see <a href="#inequs">below</a>), and are suspected to satisfy even more; and for practical purposes because they, and products of them, provide a reasonably large, yet accessible, class of cones which is easy to analyze with respect to the intrinsic volumes.</p>
<p>A circular cone is self-dual iff the angle is <span class="math inline">\(\pi/4\)</span>. These special cones are called Lorentz cone or ice-cream cone. We denote these by <span class="math inline">\(\mathcal{L}^d=\text{Circ}_d(\pi/4)\)</span>.</p>
</div>
<div id="ellips_cone" class="section level3">
<h3 class="hasAnchor">
<a href="#ellips_cone" class="anchor"></a>Examples: ellipsoidal cones</h3>
Ellipsoidal cones generalize the class of circular cones; they can be defined as full-dimensional linear images of Lorentz cones, <span class="math display">\[ \big\{\text{ellipsoidal cones in }\text{R}^d\big\}
    = \big\{A\mathcal{L}^d\mid A\in\text{R}^{d\times d} \text{ invertible} \big\} . \]</span> Every <span class="math inline">\(d\)</span>-dimensional ellipsoidal cone is isometric to a cone of the form
<span class="math display">\[\begin{align*}
   \mathcal{E}_\alpha &amp; = \text{diag}(\alpha_1,\ldots,\alpha_{d-1},1)\mathcal{L}^d
\\ &amp; = \Big\{ x\in\text{R}^d\mid x_d\geq0,\;  x_d^2\geq\sum_{k=1}^{d-1}\frac{x_k^2}{\alpha_k^2}\Big\}
\end{align*}\]</span>
<p>with <span class="math inline">\(\alpha_1\geq\dots\geq\alpha_{d-1}&gt;0\)</span>, the semiaxes of the cone. See the <a href="#proof_ellips">appendix</a> for a proof of that fact. The proof also shows how to compute the semiaxes: if <span class="math inline">\(-\lambda_1\leq\dots\leq-\lambda_{d-1}&lt;0\)</span> and <span class="math inline">\(\mu&gt;0\)</span> denote the eigenvalues of <span class="math inline">\(AJA^T\)</span>, where <span class="math inline">\(J=\text{diag}(-1,\ldots,-1,1)\)</span>, then the semiaxes of <span class="math inline">\(A\)</span> are given by <span class="math inline">\(\alpha_k=\sqrt{\lambda_k/\mu}\)</span>, <span class="math inline">\(k=1,\ldots,d-1\)</span>. This calculation is implemented in <code>ellips_semiax</code>.</p>
Note that the circular cone <span class="math inline">\(\text{Circ}_d(\alpha)\)</span> has all semiaxes equal to <span class="math inline">\(\tan(\alpha)\)</span>. The semiaxes of the polar of <span class="math inline">\(\mathcal{E}_\alpha\)</span> are given by <span class="math inline">\(\frac{1}{\alpha_{d-1}}\geq\dots\geq\frac{1}{\alpha_1}&gt;0\)</span>, as
<span class="math display">\[\begin{align*}
   \mathcal{E}_\alpha^\circ &amp; = (\text{diag}(\alpha_1,\ldots,\alpha_{d-1},1)\mathcal{L}^d)^\circ
  = -\text{diag}(\alpha_1,\ldots,\alpha_{d-1},1)^{-T}\mathcal{L}^d
\\ &amp; = -\text{diag}(1/\alpha_1,\ldots,1/\alpha_{d-1},1)\mathcal{L}^d
   = -\mathcal{E}_{1/\alpha} .
\end{align*}\]</span>
<p><strong>Example computations:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="dv">5</span>
<span class="kw"><a href="../reference/ellips_semiax.html">ellips_semiax</a></span>( <span class="kw">diag</span>(d:<span class="dv">1</span>) )
<span class="co">#&gt; [1] 5 4 3 2</span></code></pre></div>
<p>The semiaxes of an ellipsoidal cone in standard form are surely found; let’s also test if they are found for a randomly rotated cone:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Q &lt;-<span class="st"> </span><span class="kw">svd</span>( <span class="kw">matrix</span>(<span class="kw">rnorm</span>(d^<span class="dv">2</span>),d,d) )$u  <span class="co"># find random rotation</span>
<span class="kw">round</span>( <span class="kw">t</span>(Q) %*%<span class="st"> </span>Q, <span class="dv">14</span> )               <span class="co"># test orthogonality</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; [1,]    1    0    0    0    0</span>
<span class="co">#&gt; [2,]    0    1    0    0    0</span>
<span class="co">#&gt; [3,]    0    0    1    0    0</span>
<span class="co">#&gt; [4,]    0    0    0    1    0</span>
<span class="co">#&gt; [5,]    0    0    0    0    1</span>
<span class="kw"><a href="../reference/ellips_semiax.html">ellips_semiax</a></span>( Q %*%<span class="st"> </span><span class="kw">diag</span>(d:<span class="dv">1</span>) )      <span class="co"># compute semiaxes of rotated cone</span>
<span class="co">#&gt; [1] 5 4 3 2</span></code></pre></div>
</div>
</div>
<div id="intro_intrvol" class="section level2">
<h2 class="hasAnchor">
<a href="#intro_intrvol" class="anchor"></a>Conic intrinsic volumes</h2>
<p>The conic intrinsic volumes of a closed convex cone <span class="math inline">\(C\subseteq\text{R}^d\)</span> form a <span class="math inline">\((d+1)\)</span>-element vector, <span class="math display">\[ v(C) = (v_0(C),\ldots,v_d(C)) \geq 0 ,\quad \sum_{k=0}^d v_k(C) = 1 . \]</span> Since this vector lies in the probability simplex, it defines a corresponding categorical distribution on <span class="math inline">\(\{0,\ldots,d\}\)</span>, which we will refer to as the intrinsic volumes distribution.</p>
<p>If <span class="math inline">\(C\)</span> is a polyhedral cone, then the intrinsic volumes can be characterized in the following way: letting <span class="math inline">\(g\sim N(0,I_d)\)</span> a Gaussian vector (coordinates are iid standard normal) and denoting the projection map onto <span class="math inline">\(C\)</span> by <span class="math inline">\(\Pi_C\colon\text{R}^d\to C\)</span>, <span class="math inline">\(\Pi_C(z) = \text{argmin}\{\|x-z\|\mid x\in C\}\)</span>, the <span class="math inline">\(k\)</span>th intrinsic volume is given as the probability that <span class="math inline">\(\Pi_C(g)\)</span> lies in the relative interior of a <span class="math inline">\(k\)</span>-dimensional face of <span class="math inline">\(C\)</span>, <span class="math display">\[ v_k(C) = \text{Prob}\big\{\Pi_C(g)\in \text{relint}(F), F \text{ face of }C, \dim(F)=k\big\} . \]</span> This characterization holds exclusively for polyhedral cones.</p>
<p>Note that the above characterization also provides a simple way to sample from the intrinsic volumes distribution: sample a Gaussian vector, project it onto the cone <span class="math inline">\(C\)</span>, determine the dimension of the face containing the projection in its relative interior. This procedure is implemented in <code>polyh_rivols_gen</code> and <code>polyh_rivols_ineq</code>.</p>
<p>If <span class="math inline">\(C=L\)</span> is a linear subspace, then <span class="math display">\[ v_k(L) = \begin{cases} 1 &amp; \text{if } k=\dim(L) \\ 0 &amp; \text{else} . \end{cases} \]</span> It can be shown that if <span class="math inline">\(C\)</span> is <em>not</em> a linear subspace, then <span class="math display">\[ v_0(C)+v_2(C)+v_4(C)+\cdots = v_1(C)+v_3(C)+v_5(C)+\cdots = \tfrac{1}{2} . \]</span> This linear relation is the reason why in the computations in the <code>conivol</code> functions the underlying closed convex cone is generally assumed to be not a linear subspace.</p>
<p>The intrinsic volumes of the polar cone are the same as those of the primal cone, but the index gets reversed, <span class="math display">\[ v_k(C^\circ) = v_{d-k}(C) . \]</span> The intrinsic volumes of a product of cones arise as the convolution of the intrinsic volumes of its components, <span class="math display">\[ v_k(C\times D) = \sum_{i+j=k} v_i(C) v_j(D) . \]</span> This convolution is conveniently implemented in <code>prod_ivols</code>.</p>
<p>From the natural orthogonal decomposition <span class="math inline">\(C = L + \bar C\)</span>, where <span class="math inline">\(L=C\cap (-C)\)</span> and <span class="math inline">\(\bar C=\Pi_{L^\bot}(C)\)</span>, one can show that <span class="math inline">\(v_k(C)=0\)</span> if <span class="math inline">\(k&lt;\text{lin}(C)\)</span> or <span class="math inline">\(k&gt;\text{dim}(C)\)</span> and<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> <span class="math display">\[ v_k(C)=v_{k-\text{lin}(C)}(\bar C)&gt;0 \quad\text{for}\quad
    \text{lin}(C)\leq k\leq\text{dim}(C) . \]</span></p>
<div id="statdim" class="section level3">
<h3 class="hasAnchor">
<a href="#statdim" class="anchor"></a>Statistical dimension and variance</h3>
<p>The first moment of intrinsic volumes distribution of a cone is called its statistical dimension, <span class="math display">\[ \delta(C) = \sum_{k=0}^d k v_k(C) . \]</span> Note that the statistical dimension coincides with the (linear) dimension if <span class="math inline">\(C\)</span> is a linear subspace. It also generalizes some other properties, such as <span class="math inline">\(\delta(C^\circ)=d-\delta(C)\)</span> and <span class="math inline">\(\delta(C\times D)=\delta(C)+\delta(D)\)</span>.</p>
<p>For later use we also define the variance of the cone via <span class="math display">\[ \text{var}(C) = \sum_{k=0}^d (k-\delta(C))^2 v_k(C) . \]</span></p>
<p><strong>Example computations:</strong></p>
<p>We start with an illustration of the convolution process for intrinsic volumes of product cones. Note that the intrinsic volumes of a one-dimensional half-line are given by <span class="math inline">\((\frac12,\frac12)\)</span>. The product of <span class="math inline">\(n\)</span> half-lines yields the positive orthant whose intrinsic volumes are given by the (normalized) binomial coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v_halfline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">2</span>,<span class="dv">1</span>/<span class="dv">2</span>); v_halfline
<span class="co">#&gt; [1] 0.5 0.5</span>
<span class="dv">2</span>^<span class="dv">4</span> *<span class="st"> </span><span class="kw"><a href="../reference/prod_ivols.html">prod_ivols</a></span>( <span class="kw">list</span>(v_halfline, v_halfline, v_halfline, v_halfline) )
<span class="co">#&gt; [1] 1 4 6 4 1</span></code></pre></div>
<p>For another example, consider the data on signatures of mutational processes in human cancer as presented in <span class="citation">(Alexandrov Ludmil B. et al. <a href="#ref-Aetal13">2013</a>)</span>. The data consists of proportions of 96 mutation types in 30 different types of cancer:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">address &lt;-<span class="st"> "http://cancer.sanger.ac.uk/cancergenome/assets/signatures_probabilities.txt"</span>
A_canc &lt;-<span class="st"> </span>readr::<span class="kw">read_tsv</span>(address)[ , <span class="dv">1</span>:<span class="dv">33</span>]
A &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(A_canc[ , <span class="dv">4</span>:<span class="dv">33</span>])</code></pre></div>
<p>A quick look at the data…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(A)
<span class="co">#&gt; [1] 96 30</span>
A[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>]
<span class="co">#&gt;      Signature 1  Signature 2 Signature 3 Signature 4 Signature 5</span>
<span class="co">#&gt; [1,] 0.011098326 6.827082e-04  0.02217231      0.0365 0.014941548</span>
<span class="co">#&gt; [2,] 0.009149341 6.191072e-04  0.01787168      0.0309 0.008960918</span>
<span class="co">#&gt; [3,] 0.001490070 9.927896e-05  0.00213834      0.0183 0.002207846</span>
<span class="co">#&gt; [4,] 0.006233885 3.238914e-04  0.01626515      0.0243 0.009206905</span>
<span class="co">#&gt; [5,] 0.001801068 2.634810e-04  0.02400262      0.0097 0.011671022</span>
<span class="kw">all</span>(A&gt;=<span class="dv">0</span>)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">colSums</span>(A)
<span class="co">#&gt;  Signature 1  Signature 2  Signature 3  Signature 4  Signature 5 </span>
<span class="co">#&gt;            1            1            1            1            1 </span>
<span class="co">#&gt;  Signature 6  Signature 7  Signature 8  Signature 9 Signature 10 </span>
<span class="co">#&gt;            1            1            1            1            1 </span>
<span class="co">#&gt; Signature 11 Signature 12 Signature 13 Signature 14 Signature 15 </span>
<span class="co">#&gt;            1            1            1            1            1 </span>
<span class="co">#&gt; Signature 16 Signature 17 Signature 18 Signature 19 Signature 20 </span>
<span class="co">#&gt;            1            1            1            1            1 </span>
<span class="co">#&gt; Signature 21 Signature 22 Signature 23 Signature 24 Signature 25 </span>
<span class="co">#&gt;            1            1            1            1            1 </span>
<span class="co">#&gt; Signature 26 Signature 27 Signature 28 Signature 29 Signature 30 </span>
<span class="co">#&gt;            1            1            1            1            1</span></code></pre></div>
<p>In order to better understand the landscape of mutational signatures one might be interested in the conic intrinsic volumes of the cone generated by this matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="fl">1e5</span>
S &lt;-<span class="st"> </span><span class="kw"><a href="../reference/polyh_rivols.html">polyh_rivols_gen</a></span>(n,A)         <span class="co"># sampling from intrinsic volumes distribution</span>

<span class="kw">str</span>(S)
<span class="co">#&gt; List of 7</span>
<span class="co">#&gt;  $ dimC     : int 30</span>
<span class="co">#&gt;  $ linC     : int 0</span>
<span class="co">#&gt;  $ QL       : logi NA</span>
<span class="co">#&gt;  $ QC       : num [1:96, 1:30] -0.0542 -0.0399 -0.0121 -0.0439 -0.0188 ...</span>
<span class="co">#&gt;  $ A_reduced: num [1:30, 1:30] -0.1396 0.085 -0.0189 0.0348 -0.0435 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:30] "Signature 1" "Signature 2" "Signature 3" "Signature 4" ...</span>
<span class="co">#&gt;  $ samples  : int [1:100000] 5 4 7 4 3 7 4 6 6 8 ...</span>
<span class="co">#&gt;  $ multsamp : int [1:97] 306 2203 7178 14297 19892 20651 16553 10351 5407 2115 ...</span>
linC &lt;-<span class="st"> </span>S$linC
dimC &lt;-<span class="st"> </span>S$dimC
msamp &lt;-<span class="st"> </span>S$multsamp</code></pre></div>
<p>We can look at the point estimate for the intrinsic volumes given by this sample:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tib_plot &lt;-<span class="st"> </span><span class="kw">tibble</span>( <span class="dt">k=</span>linC:dimC, <span class="dt">value=</span>msamp[<span class="dv">1</span>+linC:dimC]/n )
<span class="kw">ggplot</span>(tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span>value))      +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/plot-canc-samp-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span><span class="kw">log</span>(value))) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/plot-canc-samp-2.png" width="672" style="display: block; margin: auto;"></p>
<p>We can also look at the corresponding Bayes posterior:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bayes_est &lt;-<span class="st"> </span><span class="kw"><a href="../reference/polyh_bayes.html">polyh_bayes</a></span>( msamp, dimC, linC )
tib_plot_bay &lt;-<span class="st"> </span>bayes_est$<span class="kw">post_samp</span>(<span class="fl">1e4</span>) %&gt;%
<span class="st">    </span><span class="kw">as_tibble</span>() %&gt;%
<span class="st">    `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">"V"</span>,dimC-linC<span class="dv">+1</span>),<span class="kw">as.character</span>(linC:dimC))) %&gt;%
<span class="st">    </span><span class="kw">gather</span>(<span class="dt">factor_key=</span><span class="ot">TRUE</span>)
<span class="kw">ggplot</span>(tib_plot_bay, <span class="kw">aes</span>(<span class="dt">x=</span>key, <span class="dt">y=</span>value)) +
<span class="st">    </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(), <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/canc-bayes-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Of course, the error bars are not too interesting in this case, as the sample size is quite large. So for illustration purpose we resample with much smaller sample size:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_sm &lt;-<span class="st"> </span><span class="fl">3e2</span>
<span class="kw">set.seed</span>(<span class="dv">1111</span>)
S_sm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/polyh_rivols.html">polyh_rivols_gen</a></span>(n_sm,A)
msamp_sm &lt;-<span class="st"> </span>S_sm$multsamp

<span class="co"># point estimate:</span>
tib_plot_sm &lt;-<span class="st"> </span><span class="kw">tibble</span>( <span class="dt">k=</span>linC:dimC, <span class="dt">value=</span>msamp_sm[<span class="dv">1</span>+linC:dimC]/n_sm )
<span class="kw">ggplot</span>(tib_plot_sm, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span>value)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span>value), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"red"</span>)</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/samp-canc-data-small-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tib_plot_sm, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span><span class="kw">log</span>(value))) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span><span class="kw">log</span>(value)), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"red"</span>)</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/samp-canc-data-small-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Bayes posterior:</span>
bayes_est_sm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/polyh_bayes.html">polyh_bayes</a></span>( msamp_sm, dimC, linC )
tib_plot_bay_sm &lt;-<span class="st"> </span>bayes_est_sm$<span class="kw">post_samp</span>(<span class="fl">1e4</span>) %&gt;%
<span class="st">    </span><span class="kw">as_tibble</span>() %&gt;%
<span class="st">    `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">"V"</span>,dimC-linC<span class="dv">+1</span>),<span class="kw">as.character</span>(linC:dimC))) %&gt;%
<span class="st">    </span><span class="kw">gather</span>(<span class="dt">factor_key=</span><span class="ot">TRUE</span>)
<span class="kw">ggplot</span>(tib_plot_bay_sm, <span class="kw">aes</span>(<span class="dt">x=</span>key, <span class="dt">y=</span>value)) +
<span class="st">    </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(), <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>()) +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k<span class="dv">+1</span>, <span class="dt">y=</span>value), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"red"</span>)</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/samp-canc-data-small-3.png" width="672" style="display: block; margin: auto;"></p>
<p>In a situation with too few data points one may improve the estimate by assuming <em>log-concavity</em> of the intrinsic volumes; see the discussion <a href="#log-conc">below</a> for more information about log-concavity of intrinsic volumes. The package <code>logcondiscr</code> (<a href="https://cran.r-project.org/web/packages/logcondiscr/index.html">CRAN</a>) offers functionalities to compute the log-concave maximum likelihood estimate, see <span class="citation">(Balabdaoui et al. <a href="#ref-BJRP13">2013</a>)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logconc_MLE &lt;-<span class="st"> </span><span class="kw">logConDiscrMLE</span>(S_sm$samples, <span class="dt">output=</span><span class="ot">FALSE</span>)
log_est &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,dimC-linC<span class="dv">+1</span>)
log_est[logconc_MLE$x+linC<span class="dv">+1</span>] &lt;-<span class="st"> </span><span class="kw">exp</span>(logconc_MLE$psi)

<span class="co"># log-concavity improved point estimate:</span>
tib_plot_logc &lt;-<span class="st"> </span><span class="kw">tibble</span>( <span class="dt">k=</span>linC:dimC, <span class="dt">value=</span>log_est )
<span class="kw">ggplot</span>(tib_plot_logc, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span>value)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot_sm, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span>value), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"blue"</span>) +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span>value), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"red"</span>)</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/samp-canc-data-logconc-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tib_plot_logc, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span><span class="kw">log</span>(value))) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot_sm, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span><span class="kw">log</span>(value)), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"blue"</span>) +
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data=</span>tib_plot, <span class="kw">aes</span>(<span class="dt">x=</span>k, <span class="dt">y=</span><span class="kw">log</span>(value)), <span class="dt">linetype=</span><span class="st">"dashed"</span>, <span class="dt">color=</span><span class="st">"red"</span>)</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/samp-canc-data-logconc-2.png" width="672" style="display: block; margin: auto;"></p>
<p>As for Bayesian posteriors enforcing log-concavity, <code>conivol</code> supports this functionality through the MCMC sampler <a href="http://mc-stan.org/">Stan</a>. See the vignette on <a href="bayesian.html">Bayesian estimates for conic intrinsic volumes</a> for information and example computations for this case.</p>
</div>
<div id="ex_weyl" class="section level3">
<h3 class="hasAnchor">
<a href="#ex_weyl" class="anchor"></a>Examples: Weyl chambers of finite reflection groups</h3>
The intrinsic volumes of the Weyl chambers are easily given through their generating function:
<span class="math display">\[\begin{align*}
   \sum_{k=0}^{d+1} v_k(C_A)\, x^k &amp; = \frac{1}{(d+1)!} \prod_{k=1}^{d+1} (x+k-1) ,
\\ \sum_{k=0}^d v_k(C_{BC})\, x^k &amp; = \frac{1}{d!\,2^d}\prod_{k=1}^d (x+2k-1) ,
\\ \sum_{k=0}^d v_k(C_D)\, x^k &amp; = \frac{1}{d!\,2^{d-1}}(x+d-1)\prod_{k=1}^{d-1} (x+2k-1) .
\end{align*}\]</span>
<p>Note that the intrinsic volumes of <span class="math inline">\(C_A\)</span> are the normalized <a href="https://en.wikipedia.org/wiki/Stirling_numbers_of_the_first_kind">Stirling numbers of the first kind</a>. These formulas are implemented in <code>weyl_ivols</code>.</p>
<p><strong>Example computations:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">factorial</span>(<span class="dv">6</span>) *<span class="st"> </span><span class="kw"><a href="../reference/weyl_ivols.html">weyl_ivols</a></span>(<span class="dv">5</span>,<span class="st">"A"</span>)
<span class="co">#&gt; [1]   0 120 274 225  85  15   1</span>
<span class="kw">factorial</span>(<span class="dv">6</span>) *<span class="st"> </span><span class="kw"><a href="../reference/weyl_ivols.html">weyl_ivols</a></span>(<span class="dv">5</span>,<span class="st">"A_red"</span>)   <span class="co"># intrinsic volumes of reduced cone are just shifted</span>
<span class="co">#&gt; [1] 120 274 225  85  15   1</span>
<span class="dv">2</span>^<span class="dv">5</span>*<span class="kw">factorial</span>(<span class="dv">5</span>) *<span class="st"> </span><span class="kw"><a href="../reference/weyl_ivols.html">weyl_ivols</a></span>(<span class="dv">5</span>,<span class="st">"BC"</span>)
<span class="co">#&gt; [1]  945 1689  950  230   25    1</span>
<span class="dv">2</span>^<span class="dv">4</span>*<span class="kw">factorial</span>(<span class="dv">5</span>) *<span class="st"> </span><span class="kw"><a href="../reference/weyl_ivols.html">weyl_ivols</a></span>(<span class="dv">5</span>,<span class="st">"D"</span>)
<span class="co">#&gt; [1] 420 809 520 150  20   1</span></code></pre></div>
<p>The intrinsic volumes of product cones are obtained via convolution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">factorial</span>(<span class="dv">6</span>)*<span class="dv">2</span>^<span class="dv">5</span>*<span class="kw">factorial</span>(<span class="dv">5</span>) *<span class="st"> </span><span class="kw"><a href="../reference/weyl_ivols.html">weyl_ivols</a></span>( <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>) , <span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"BC"</span>), <span class="dt">product=</span><span class="ot">TRUE</span> )
<span class="co">#&gt;  [1]      0 113400 461610 789411 748250 437510 165750  41388   6750    690</span>
<span class="co">#&gt; [11]     40      1</span>

v_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/weyl_ivols.html">weyl_ivols</a></span>( <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>) , <span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"BC"</span>) )
<span class="kw">factorial</span>(<span class="dv">6</span>)*<span class="dv">2</span>^<span class="dv">5</span>*<span class="kw">factorial</span>(<span class="dv">5</span>) *<span class="st"> </span><span class="kw"><a href="../reference/prod_ivols.html">prod_ivols</a></span>(v_list)
<span class="co">#&gt;  [1]      0 113400 461610 789411 748250 437510 165750  41388   6750    690</span>
<span class="co">#&gt; [11]     40      1</span></code></pre></div>
</div>
<div id="ex_circ_con" class="section level3">
<h3 class="hasAnchor">
<a href="#ex_circ_con" class="anchor"></a>Examples: circular cones</h3>
<p>The intrinsic volumes of circular cones are given by the following formulas: <span class="math display">\[ v_k(\text{Circ}_d(\alpha)) = \begin{cases}
       \displaystyle\frac{\Gamma(\frac{d}{2})}{\Gamma(\frac{k+1}{2})\Gamma(\frac{d-k+1}{2})}
            \frac{p^{(k-1)/2} (1-p)^{(d-k-1)/2}}{2} &amp; \text{if } 0&lt;k&lt;d
    \\[1mm] \displaystyle\frac{I_p(\tfrac{d-1}{2},\tfrac{1}{2})}{2} &amp; \text{if } k=d
    \\[1mm] \displaystyle\frac{I_{1-p}(\tfrac{d-1}{2},\tfrac{1}{2})}{2} &amp; \text{if } k=0
    \end{cases} \]</span> where <span class="math inline">\(p=\sin^2(\alpha)\)</span> and where <span class="math inline">\(I_p(a,b)\)</span> denotes the <a href="https://en.wikipedia.org/wiki/Beta_function#Incomplete_beta_function">regularized incomplete beta function</a>, that is, the cdf of the corresponding Beta distribution. These formulas are implemented in <code>circ_ivols</code>.</p>
<p>Note that if <span class="math inline">\(d\)</span> is even, then the intrinsic volumes with odd indices form the (half-)weights of a binomial distribution: <span class="math display">\[ 2v_{2k+1}(\text{Circ}_d(\alpha)) = \binom{d/2-1}{k} p^k (1-p)^{d/2-1-k} . \]</span></p>
<p><strong>Example computations:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw"><a href="../reference/circ_ivols.html">circ_ivols</a></span>(<span class="dv">10</span>,pi/<span class="dv">5</span>)
v
<span class="co">#&gt;  [1] 0.028604594 0.091755300 0.155208053 0.193737296 0.191167084</span>
<span class="co">#&gt;  [6] 0.153400429 0.100910230 0.053983047 0.022828664 0.007123927</span>
<span class="co">#&gt; [11] 0.001281375</span>
<span class="kw">sum</span>(v)
<span class="co">#&gt; [1] 1</span>
<span class="kw">sum</span>( v[ <span class="dv">2</span>*(<span class="dv">1</span>:<span class="dv">5</span>) ] )       <span class="co"># odd index intrinsic volumes add up to 1/2</span>
<span class="co">#&gt; [1] 0.5</span>

<span class="dv">2</span> *<span class="st"> </span>v[ <span class="dv">2</span>*(<span class="dv">1</span>:<span class="dv">5</span>) ]          <span class="co"># comparing with binomial distribution</span>
<span class="co">#&gt; [1] 0.18351060 0.38747459 0.30680086 0.10796609 0.01424785</span>
<span class="kw">dbinom</span>(<span class="dv">0</span>:<span class="dv">4</span>,<span class="dv">4</span>,<span class="kw">sin</span>(pi/<span class="dv">5</span>)^<span class="dv">2</span>)
<span class="co">#&gt; [1] 0.18351060 0.38747459 0.30680086 0.10796609 0.01424785</span></code></pre></div>
</div>
</div>
<div id="bivchibarsq" class="section level2">
<h2 class="hasAnchor">
<a href="#bivchibarsq" class="anchor"></a>(Bivariate) chi-bar-squared distribution</h2>
<p>For <span class="math inline">\(k\geq0\)</span> let <span class="math inline">\(F_k\)</span> denote the cumulative distribution function (cdf) of the <span class="math inline">\(\chi_k^2\)</span> distribution, with <span class="math inline">\(F_0(t)=1_{\geq0}(t)\)</span>. The chi-bar-squared distribution with weight vector <span class="math inline">\(v=(v_0,\ldots,v_d)\)</span>, where <span class="math inline">\(v\geq0\)</span> and <span class="math inline">\(\sum_{k=0}^dv_k=1\)</span>, can be characterized through its cdf via <span class="math display">\[ F_v(t) = \sum_{k=0}^d v_k F_k(t) . \]</span> In terms of random variables, one can think of sampling from the chi-bar-squared distribution as a two-step procedure:</p>
<ol style="list-style-type: decimal">
<li>sample an index <span class="math inline">\(k\in\{0,\ldots,d\}\)</span> from the categorical distribution defined by the weight vector <span class="math inline">\(v\)</span>,</li>
<li>sample an element from the <span class="math inline">\(\chi_k^2\)</span> distribution.</li>
</ol>
<p>The bivariate chi-bar-squared distribution with weight vector <span class="math inline">\(v\)</span> can similarly be characterized through its cdf via <span class="math display">\[ \Phi_v(s,t) = \sum_{k=0}^d v_k F_k(s) F_{d-k}(t) . \]</span> In terms of random variables, one can again think of sampling <span class="math inline">\((x,y)\)</span> from the chi-bar-squared distribution as a two-step procedure:</p>
<ol style="list-style-type: decimal">
<li>sample an index <span class="math inline">\(k\in\{0,\ldots,d\}\)</span> according to the distribution defined by the weight vector <span class="math inline">\(v\)</span>,</li>
<li>sample an element <span class="math inline">\(s\)</span> from the <span class="math inline">\(\chi_k^2\)</span> distribution and, independently, sample an element <span class="math inline">\(t\)</span> from the <span class="math inline">\(\chi_{d-k}^2\)</span> distribution.</li>
</ol>
<p>This sampling procedure is useful for the understanding of the EM algorithm in <code>estim_em</code> but for the relation to closed convex cones the following sampling procedure of the chi-bar-squared distribution is more intuitive:</p>
<ol style="list-style-type: decimal">
<li>sample <span class="math inline">\(d\)</span> iid <span class="math inline">\(\chi_1^2\)</span> distributed random variables, say, <span class="math inline">\(a_1,\ldots,a_d\)</span>,</li>
<li>sample an index <span class="math inline">\(k\in\{0,\ldots,d\}\)</span> according to the distribution defined by the weight vector <span class="math inline">\(v\)</span>,</li>
<li>take <span class="math inline">\(s=a_1+\cdots+a_k\)</span> and <span class="math inline">\(t=a_{k+1}+\cdots+a_d\)</span>.</li>
</ol>
<div id="bivchibars_cone" class="section level3">
<h3 class="hasAnchor">
<a href="#bivchibars_cone" class="anchor"></a>Relation to closed convex cones</h3>
<p>The (bivariate) chi-bar-squared distribution corresponding to a closed convex cone <span class="math inline">\(C\)</span> is of course the one arising from taking the conic intrinsic volumes as weights; in terms of the cdf, <span class="math display">\[ F_C(t) = \sum_{k=0}^d v_k(C) F_k(t) ,\qquad \Phi_C(s,t) = \sum_{k=0}^d v_k(C) F_k(s) F_{d-k}(t) . \]</span> A natural sampling for these distributions (without knowing the intrinsic volumes) involves the projection map <span class="math inline">\(\Pi_C\)</span>. Denoting by <span class="math inline">\(g\sim N(0,I_d)\)</span> again a Gaussian vector, one can show that the chi-bar-squared and the bivariate chi-bar-squared distributions are given by the distributions of the random variables <span class="math display">\[ \|\Pi_C(g)\|^2 \quad\text{and}\quad \big(\|\Pi_C(g)\|^2,\|\Pi_{C^\circ}(g)\|^2\big) . \]</span> The fact that these random variables have the (bivariate) chi-bar-squared distribution with weights given by the conic intrinsic volumes is one form of the Conic Steiner Theorem, see <span class="citation">(McCoy and Tropp <a href="#ref-McCT14">2014</a>)</span>.</p>
The moments of the continuous random variables <span class="math inline">\(\|\Pi_C(g)\|^2, \|\Pi_{C^\circ}(g)\|^2\)</span> are closely related with those of the discrete random variable defined by the intrinsic volumes. In fact, for the first and second moment we obtain the following:
<span class="math display">\[\begin{align*}
  \delta(C) &amp; = \text{E}\big[\|\Pi_C(g)\|^2\big]
\\ &amp; = d-\text{E}\big[\|\Pi_{C^\circ}(g)\|^2\big] ,
\\ \text{var}(C) &amp; = \text{var}\big(\|\Pi_C(g)\|^2\big)-2\delta(C)
\\ &amp; = \text{var}\big(\|\Pi_{C^\circ}(g)\|^2\big)-2(d-\delta(C)) .
\end{align*}\]</span>
<p>These formulas underlie the estimation that is implemented in <code>estim_statdim_var</code>. See the <a href="../doc/estim-conic-intrinsic-volumes-with-EM.html#start_EM">EM algorithm vignette</a> for more details.</p>
<p><strong>Example computations:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sample from the bivariate chi-bar-squared distribution of a product of circular cones</span>
D &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">17</span>)
alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.7</span>*pi/<span class="dv">2</span>, <span class="fl">0.6</span>*pi/<span class="dv">2</span>)
v_true &lt;-<span class="st"> </span><span class="kw"><a href="../reference/circ_ivols.html">circ_ivols</a></span>( D, alpha, <span class="dt">product=</span><span class="ot">TRUE</span>)
m_samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bichibarsq.html">rbichibarsq</a></span>(<span class="fl">1e5</span>, v_true)
d &lt;-<span class="st"> </span><span class="kw">sum</span>(D)

<span class="co"># scatter plot of the sample</span>
<span class="kw">ggplot</span>(<span class="kw">as_tibble</span>(m_samp), <span class="kw">aes</span>(V1,V2)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span>.<span class="dv">02</span>) +
<span class="st">    </span><span class="kw">theme_bw</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),<span class="dt">axis.title.y=</span><span class="kw">element_blank</span>())</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/biv-chi-bar-sq-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># estimate moments, compare with true values</span>
est &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estim_statdim_var.html">estim_statdim_var</a></span>(d, m_samp); est
<span class="co">#&gt; $delta</span>
<span class="co">#&gt; [1] 15.84497</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $var</span>
<span class="co">#&gt; [1] 8.348348</span>
<span class="kw">list</span>( <span class="dt">statdim_true=</span><span class="kw">sum</span>((<span class="dv">0</span>:d)*v_true),
      <span class="dt">var_true=</span><span class="kw">sum</span>((<span class="dv">0</span>:d)^<span class="dv">2</span>*v_true)-<span class="kw">sum</span>((<span class="dv">0</span>:d)*v_true)^<span class="dv">2</span> )
<span class="co">#&gt; $statdim_true</span>
<span class="co">#&gt; [1] 15.83725</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $var_true</span>
<span class="co">#&gt; [1] 8.656292</span></code></pre></div>
</div>
</div>
<div id="inequs" class="section level2">
<h2 class="hasAnchor">
<a href="#inequs" class="anchor"></a>Inequalities, known and conjectured</h2>
<p>Finally, we collect inequalities, known and conjectured, that help our understanding of the intrinsic volumes, and that have already or might potentially prove useful in applications. In particular, the log-concavity inequalities are useful in the estimation of intrinsic volumes from sampling data.</p>
<div id="ineq_tailf" class="section level3">
<h3 class="hasAnchor">
<a href="#ineq_tailf" class="anchor"></a>Inequalities from (half-)tail functionals</h3>
The tail and half-tail functionals <span class="math inline">\(t_k\)</span> and <span class="math inline">\(h_k\)</span> are defined via
<span class="math display">\[\begin{align*}
   t_k &amp; = v_k + v_{k+1} + v_{k+2} + \dots ,
 &amp; h_k &amp; = 2(v_k + v_{k+2} + v_{k+4} + \dots) .
\end{align*}\]</span>
<p>Note that <span class="math inline">\(t_k=(h_k+h_{k+1})/2\)</span>, so the following inequalities for <span class="math inline">\(t_k\)</span> follow directly from those for <span class="math inline">\(h_k\)</span>.</p>
The above two-functionals are monotonically increasing in both the indices and in the arguments: let <span class="math inline">\(C,D\)</span> be cones with <span class="math inline">\(C\subseteq D\)</span>,
<span class="math display">\[\begin{align*}
   t_k(C) &amp; \leq t_{k+1}(C) , &amp; t_k(C) &amp; \leq t_k(D) ,
 &amp; h_k(C) &amp; \leq h_{k+1}(C) , &amp; h_k(C) &amp; \leq h_k(D) .
\end{align*}\]</span>
</div>
<div id="isop_ineq" class="section level3">
<h3 class="hasAnchor">
<a href="#isop_ineq" class="anchor"></a>Isoperimetric inequalities</h3>
Broadly speaking, (classical) isoperimetric inequalities compare surface area and volume of an object with those of a “round” object (in quotes because isoperimetric inequalities are known not only in Euclidean spaces but in curved spaces as well). In the context of convex cones one can find the following formulation: if <span class="math inline">\(C\subseteq\text{R}^d\)</span> is a closed convex cone and if the angle <span class="math inline">\(\alpha\)</span> is such that <span class="math inline">\(v_{d-1}(C)=v_{d-1}(\text{Circ}_d(\alpha))\)</span> then <span class="math display">\[ v_d(C)\leq v_d(\text{Circ}_d(\alpha)) . \]</span> Note that <span class="math inline">\(v_d(C)=t_d(C)=h_d(C)/2\)</span>. Makowski and Scheuer <span class="citation">(<a href="#ref-MS16">2016</a>)</span> added to this inequality the following:
<span class="math display">\[\begin{align*}
   v_{d-2}(C) &amp; \geq v_{d-2}(\text{Circ}_d(\alpha)) ,
 &amp; h_{d-2k+1}(C) &amp; \geq h_{d-2k+1}(\text{Circ}_d(\alpha)) .
\end{align*}\]</span>
</div>
<div id="var_conj" class="section level3">
<h3 class="hasAnchor">
<a href="#var_conj" class="anchor"></a>Variance conjecture</h3>
<p>So far the only known inequality for the variance of the intrinsic volumes is <span class="math display">\[ \text{var}(C) \leq 2\text{min}\{\delta(C),d-\delta(C)\} , \]</span> which was shown in <span class="citation">(McCoy and Tropp <a href="#ref-McCT14">2014</a>)</span>. We think that this inequality can be greatly improved (see the example computations below) through a new form of isoperimetric inequalities.</p>
<p>We conjecture that among all <span class="math inline">\(d\)</span>-dimensional cones of a specific statistical dimension the variance of the intrinsic volumes is maximized by the corresponding <span class="math inline">\(d\)</span>-dimensional circular cone of the same statistical dimension: if <span class="math inline">\(C\subseteq\text{R}^d\)</span> is a closed convex cone, then <span class="math display">\[ \delta(C)=\delta(\text{Circ}_d)
    \quad \stackrel{?}{\Rightarrow} \quad
  \text{var}(C)\leq\text{var}(\text{Circ}_d) . \]</span> Using the tail functionals this conjecture can be quivalently stated in the form <span class="math display">\[ \sum_{k=1}^d t_k(C)=\sum_{k=1}^d t_k(\text{Circ}_d)
    \quad \stackrel{?}{\Rightarrow} \quad
  \sum_{k=1}^d k t_k(C)\leq\sum_{k=1}^d k t_k(\text{Circ}_d) . \]</span> By the above described relation between the intrinsic volumes distribution and the chi-bar-squared distribution, we can also state the conjecture in the following way: <span class="math display">\[ \text{E}\big[ \|\Pi_C(g)\|^2 \big] =
    \text{E}\big[ \|\Pi_{\text{Circ}_d}(g)\|^2 \big]
    \quad \stackrel{?}{\Rightarrow} \quad
  \text{E}\big[ \|\Pi_C(g)\|^4 \big] \leq
    \text{E}\big[ \|\Pi_{\text{Circ}_d}(g)\|^4 \big] . \]</span></p>
<p><strong>Example computations:</strong> We test the above conjecture for products of circular cones in dimension <span class="math inline">\(d=9\)</span>. We first compare the (statistical dimension, variance) plots of circular cones of dimensions <span class="math inline">\(2,3,\ldots,9\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="dv">9</span>
N &lt;-<span class="st"> </span><span class="fl">1e3</span>
alpha &lt;-<span class="st"> </span>(<span class="dv">0</span>:N)/N *<span class="st"> </span>pi/<span class="dv">2</span>

Sdim &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,d<span class="dv">-1</span>,N<span class="dv">+1</span>)
Var  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,d<span class="dv">-1</span>,N<span class="dv">+1</span>)
for (k in <span class="dv">2</span>:d) {
    V &lt;-<span class="st"> </span><span class="kw"><a href="../reference/circ_ivols.html">circ_ivols</a></span>( <span class="kw">rep</span>(k,N<span class="dv">+1</span>) , alpha)
    Sdim[k<span class="dv">-1</span>,] &lt;-<span class="st"> </span><span class="kw">sapply</span>(V, function(v) <span class="kw">return</span>(<span class="kw">sum</span>((<span class="dv">0</span>:k) *<span class="st"> </span>v)))
    Var[k<span class="dv">-1</span>,]  &lt;-<span class="st"> </span><span class="kw">sapply</span>(V, function(v) <span class="kw">return</span>(<span class="kw">sum</span>((<span class="dv">0</span>:k)^<span class="dv">2</span> *<span class="st"> </span>v)))-Sdim[k<span class="dv">-1</span>,]^<span class="dv">2</span>
}

G &lt;-<span class="st"> </span><span class="kw">ggplot</span>()
for (k in <span class="dv">2</span>:d) {
    G &lt;-<span class="st"> </span>G +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data=</span><span class="kw">tibble</span>(<span class="dt">sdim=</span>Sdim[k<span class="dv">-1</span>,],<span class="dt">var=</span>Var[k<span class="dv">-1</span>,]), <span class="kw">aes</span>(sdim,var))
}
G &lt;-<span class="st"> </span>G +<span class="st"> </span><span class="kw">theme_bw</span>()
G</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/statdim-var-circ-1.png" width="672" style="display: block; margin: auto;"> Note that considering direct products with linear subspaces just amounts to shifts along the x-axis, so we will not consider this. Instead, we consider direct products of circular cones. Note that the number of different combinations is given by the partition function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">P &lt;-<span class="st"> </span><span class="kw">parts</span>(d); P
<span class="co">#&gt;                                                                  </span>
<span class="co">#&gt;  [1,] 9 8 7 7 6 6 6 5 5 5 5 5 4 4 4 4 4 4 3 3 3 3 3 3 3 2 2 2 2 1</span>
<span class="co">#&gt;  [2,] 0 1 2 1 3 2 1 4 3 2 2 1 4 3 3 2 2 1 3 3 3 2 2 2 1 2 2 2 1 1</span>
<span class="co">#&gt;  [3,] 0 0 0 1 0 1 1 0 1 2 1 1 1 2 1 2 1 1 3 2 1 2 2 1 1 2 2 1 1 1</span>
<span class="co">#&gt;  [4,] 0 0 0 0 0 0 1 0 0 0 1 1 0 0 1 1 1 1 0 1 1 2 1 1 1 2 1 1 1 1</span>
<span class="co">#&gt;  [5,] 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 1 0 0 1 0 1 1 1 1 1 1 1 1</span>
<span class="co">#&gt;  [6,] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 1 0 1 1 1 1</span>
<span class="co">#&gt;  [7,] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 1</span>
<span class="co">#&gt;  [8,] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1</span>
<span class="co">#&gt;  [9,] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1</span></code></pre></div>
<p>Note that one-dimensional circular cones are just half-lines, so whenever a partition only contains half-lines and a single non-half-line, then we obtain a curve, as above. Collecting this in one plot, we obtain the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sing &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colSums</span>(P&gt;<span class="dv">1</span>)==<span class="dv">1</span>)

G &lt;-<span class="st"> </span><span class="kw">ggplot</span>()
for (k in sing) {
    n_ray &lt;-<span class="st"> </span><span class="kw">sum</span>(P[,k]==<span class="dv">1</span>)
    sdim &lt;-<span class="st"> </span>Sdim[ P[<span class="dv">1</span>,k]-<span class="dv">1</span>, ] +<span class="st"> </span>n_ray/<span class="dv">2</span>
    var  &lt;-<span class="st"> </span>Var[  P[<span class="dv">1</span>,k]-<span class="dv">1</span>, ] +<span class="st"> </span>n_ray/<span class="dv">4</span>
    G &lt;-<span class="st"> </span>G +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data=</span><span class="kw">tibble</span>(sdim,var), <span class="kw">aes</span>(sdim,var))
}
G &lt;-<span class="st"> </span>G +<span class="st"> </span><span class="kw">theme_bw</span>(); G</code></pre></div>
<p><img src="conic-intrinsic-volumes_figures/statdim-var-prod-curv-1.png" width="672" style="display: block; margin: auto;"> Finally, we obtain the following plots for the remaining products of circular cones: <img src="conic-intrinsic-volumes_figures/statdim-var-prod-scatter-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="log-conc" class="section level3">
<h3 class="hasAnchor">
<a href="#log-conc" class="anchor"></a>Log-concavity conjecture</h3>
<p>Log-concavity, as the name suggests, means concavity of the logarithms. In the context of intrinsic volumes this means <span class="math inline">\(\log v_k(C) \stackrel{?}{\geq} \frac{\log v_{k-1}(C)+\log v_{k+1}(C)}{2}\)</span>, equivalently, <span class="math display">\[ v_k(C)^2 \stackrel{?}{\geq} v_{k-1}(C) v_{k+1}(C) . \]</span> These inequalities imply unimodality, and are in general useful for estimating intrinsic volumes; cp. the vignettes <a href="estim-conic-intrinsic-volumes-with-EM.html">Estimating conic intrinsic volumes from bivariate chi-bar-squared data</a> and <a href="bayesian.html">Bayesian estimates for conic intrinsic volumes</a>. Unfortunately, these inequalities are so far just conjectured for general cones; they are true for circular cones, Weyl chambers, and direct products of cones for which they are known to hold.<br>
In the euclidean case the log-concavity of the euclidean intrinsic volumes follows from the <a href="https://en.wikipedia.org/wiki/Mixed_volume">Alexandrov-Fenchel inequality</a>, and it can easily be shown that log-concavity of conic intrinsic volumes directly implies log-concavity of euclidean intrinsic volumes.<br>
As for the other direction, it can be shown that in dimension <span class="math inline">\(d\leq5\)</span> log-concavity of conic intrinsic volumes does indeed hold and follows from the Alexandrov-Fenchel inequality. For general dimensions it seems that this inequality is not enough.</p>
</div>
</div>
<div id="proof_ellips" class="section level2">
<h2 class="hasAnchor">
<a href="#proof_ellips" class="anchor"></a>Appendix: Proof of ellipsoidal cone representation</h2>
Let <span class="math inline">\(C=A\mathcal L^d\)</span> for some invertible linear transformation <span class="math inline">\(A\)</span>. Consider the eigenvalue decomposition of the symmetric matrix <span class="math inline">\(AJA^T\)</span> with <span class="math inline">\(J=\text{diag}(-1,\ldots,-1,1)\)</span>: according to <a href="https://en.wikipedia.org/wiki/Singular-value_decomposition">Sylvester’s law of inertia</a> this matrix has <span class="math inline">\(d-1\)</span> negative and one positive eigenvalues. Let these be given by <span class="math inline">\(-\lambda_1&lt;\dots&lt;-\lambda_{d-1}&lt;0\)</span> and <span class="math inline">\(\mu&gt;0\)</span>, so that <span class="math display">\[ AJA^T = Q\text{diag}(-\lambda_1,\ldots,-\lambda_{d-1},\mu)Q^T , \]</span> for <span class="math inline">\(Q\in\text{R}^{d\times d}\)</span> orthogonal; taking inverses, we have <span class="math display">\[ A^{-T}JA^{-1} = Q\text{diag}(-1/\lambda_1,\ldots,-1/\lambda_{d-1},1/\mu)Q^T . \]</span> Setting <span class="math inline">\(\alpha_k=\sqrt{\lambda_k/\mu}\)</span> for <span class="math inline">\(k=1,\ldots,d-1\)</span>, we obtain
<span class="math display">\[\begin{align*}
   \mu J &amp; = A^TQ\text{diag}(-\mu/\lambda_1,\ldots,-\mu/\lambda_{d-1},1)Q^TA
\\ &amp; = A^TQ\text{diag}(\alpha_1^{-1},\ldots,\alpha_{d-1}^{-1},1) J \text{diag}(\alpha_1^{-1},\ldots,\alpha_{d-1}^{-1},1)Q^TA
\end{align*}\]</span>
<p>According to <span class="citation">(Loewy and Schneider <a href="#ref-LS75">1975</a>)</span> this implies that either <span class="math inline">\(\text{diag}(\alpha_1^{-1}, \ldots,\alpha_{d-1}^{-1},1)Q^TA\mathcal L^d=\mathcal L^d\)</span> or <span class="math inline">\(\text{diag}(\alpha_1^{-1},\ldots,\alpha_{d-1}^{-1},1)Q^TA\mathcal L^d =-\mathcal L^d\)</span>. Denoting <span class="math inline">\(\mathcal{E}_\alpha=\text{diag}(\alpha_1,\ldots,\alpha_{d-1},1)\mathcal L^d\)</span>, we see that either <span class="math inline">\(A\mathcal L^d=Q\mathcal{E}_\alpha\)</span> or <span class="math inline">\(A\mathcal L^d=-Q\mathcal{E}_\alpha\)</span>. In both cases we see that <span class="math inline">\(A\mathcal L^d\)</span> is isometric to <span class="math inline">\(\mathcal{E}_\alpha\)</span>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Aetal13">
<p>Alexandrov Ludmil B., Nik-Zainal Serena, Wedge David C., Aparicio Samuel A. J. R., Behjati Sam, Biankin Andrew V., Bignell Graham R., et al. 2013. “Signatures of mutational processes in human cancer.” <em>Nature</em> 500 (7463). Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.: 415–21. doi:<a href="https://doi.org/10.1038/nature12477">10.1038/nature12477</a>.</p>
</div>
<div id="ref-AL17">
<p>Amelunxen, Dennis, and Martin Lotz. 2017. “Intrinsic Volumes of Polyhedral Cones: A Combinatorial Perspective.” <em>Discrete Comput. Geom.</em> 58 (2): 371–409. doi:<a href="https://doi.org/10.1007/s00454-017-9904-9">10.1007/s00454-017-9904-9</a>.</p>
</div>
<div id="ref-BJRP13">
<p>Balabdaoui, Fadoua, Hanna Jankowski, Kaspar Rufibach, and Marios Pavlides. 2013. “Asymptotics of the Discrete Log-Concave Maximum Likelihood Estimator and Related Applications.” <em>J. R. Stat. Soc. Ser. B. Stat. Methodol.</em> 75 (4): 769–90. <a href="https://doi.org/10.1111/rssb.12011" class="uri">https://doi.org/10.1111/rssb.12011</a>.</p>
</div>
<div id="ref-LS75">
<p>Loewy, Raphael, and Hans Schneider. 1975. “Positive Operators on the <span class="math inline">\(n\)</span>-Dimensional Ice Cream Cone.” <em>J. Math. Anal. Appl.</em> 49: 375–92. doi:<a href="https://doi.org/10.1016/0022-247X(75)90186-9">10.1016/0022-247X(75)90186-9</a>.</p>
</div>
<div id="ref-MS16">
<p>Makowski, Matthias, and Julian Scheuer. 2016. “Rigidity Results, Inverse Curvature Flows and Alexandrov-Fenchel Type Inequalities in the Sphere.” <em>Asian J. Math.</em> 20 (5): 869–92. doi:<a href="https://doi.org/10.4310/AJM.2016.v20.n5.a2">10.4310/AJM.2016.v20.n5.a2</a>.</p>
</div>
<div id="ref-McCT14">
<p>McCoy, Michael B., and Joel A. Tropp. 2014. “From Steiner Formulas for Cones to Concentration of Intrinsic Volumes.” <em>Discrete Comput. Geom.</em> 51 (4): 926–63. doi:<a href="https://doi.org/10.1007/s00454-014-9595-4">10.1007/s00454-014-9595-4</a>.</p>
</div>
<div id="ref-WW67">
<p>Wets, Roger J.-B., and Christoph Witzgall. 1967. “Algorithms for Frames and Lineality Spaces of Cones.” <em>J. Res. Nat. Bur. Standards Sect. B</em> 71B: 1–7.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The strictly positive inequalities actually require a proof in the nonpolyhedral case (and without having log-concavity); one can deduce this from the kinematic formula by projecting the cone on a uniformly random linear subspace and looking at the volume of the (relative) boundary of the projection.<a href="#fnref1">↩</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#cl_conv_con">Closed convex cones</a></li>
      <li><a href="#intro_intrvol">Conic intrinsic volumes</a></li>
      <li><a href="#bivchibarsq">(Bivariate) chi-bar-squared distribution</a></li>
      <li><a href="#inequs">Inequalities, known and conjectured</a></li>
      <li><a href="#proof_ellips">Appendix: Proof of ellipsoidal cone representation</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dennis Amelunxen, Martin Lotz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
